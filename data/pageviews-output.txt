No of entries
root
 |-- requests: long (nullable = true)
 |-- site: string (nullable = true)
 |-- timestamp: string (nullable = true)

------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------
+--------+-------+-------------------+
|requests|   site|          timestamp|
+--------+-------+-------------------+
|    2343|desktop|2015-03-16T00:00:00|
|    1628| mobile|2015-03-16T00:00:00|
|    2382|desktop|2015-03-16T00:00:01|
|    1636| mobile|2015-03-16T00:00:01|
|    1619| mobile|2015-03-16T00:00:02|
|    2546|desktop|2015-03-16T00:00:02|
|    2402|desktop|2015-03-16T00:00:03|
|    1776| mobile|2015-03-16T00:00:03|
|    2370|desktop|2015-03-16T00:00:04|
|    1716| mobile|2015-03-16T00:00:04|
|    1721| mobile|2015-03-16T00:00:05|
|    2417|desktop|2015-03-16T00:00:05|
|    2318|desktop|2015-03-16T00:00:06|
|    1695| mobile|2015-03-16T00:00:06|
|    2580|desktop|2015-03-16T00:00:07|
|    1630| mobile|2015-03-16T00:00:07|
|    1731| mobile|2015-03-16T00:00:08|
|    2545|desktop|2015-03-16T00:00:08|
|    2366|desktop|2015-03-16T00:00:09|
|    1664| mobile|2015-03-16T00:00:09|
+--------+-------+-------------------+
only showing top 20 rows

+--------+-------+-------------------+
|requests|   site|          timestamp|
+--------+-------+-------------------+
|    1628| mobile|2015-03-16T00:00:00|
|    2343|desktop|2015-03-16T00:00:00|
|    1636| mobile|2015-03-16T00:00:01|
|    2382|desktop|2015-03-16T00:00:01|
|    1619| mobile|2015-03-16T00:00:02|
|    2546|desktop|2015-03-16T00:00:02|
|    1776| mobile|2015-03-16T00:00:03|
|    2402|desktop|2015-03-16T00:00:03|
|    1716| mobile|2015-03-16T00:00:04|
|    2370|desktop|2015-03-16T00:00:04|
|    1721| mobile|2015-03-16T00:00:05|
|    2417|desktop|2015-03-16T00:00:05|
|    1695| mobile|2015-03-16T00:00:06|
|    2318|desktop|2015-03-16T00:00:06|
|    1630| mobile|2015-03-16T00:00:07|
|    2580|desktop|2015-03-16T00:00:07|
|    1731| mobile|2015-03-16T00:00:08|
|    2545|desktop|2015-03-16T00:00:08|
|    1664| mobile|2015-03-16T00:00:09|
|    2366|desktop|2015-03-16T00:00:09|
+--------+-------+-------------------+
only showing top 20 rows

Sorted entries
------------------------------------------------------------------------------------------
No of incoming requests in mobile vs desktop
------------------------------------------------------------------------------------------
+-------+-------+
|   site|  count|
+-------+-------+
| mobile|3600000|
|desktop|3600000|
+-------+-------+

+-------------+
|sum(requests)|
+-------------+
|  13342978934|
+-------------+

------------------------------------------------------------------------------------------
Sum of requests for Mobile viewers
------------------------------------------------------------------------------------------
+-------------+
|sum(requests)|
+-------------+
|   4605797962|
+-------------+

Sum of requests for Desktop viewers
+-------------+
|sum(requests)|
+-------------+
|   8737180972|
+-------------+

------------------------------------------------------------------------------------------
Converting to timestamp
------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------
Analyzing how many diff years our data is from
------------------------------------------------------------------------------------------
+---------------+
|year(timestamp)|
+---------------+
|           2015|
+---------------+

------------------------------------------------------------------------------------------
Analyzing statistics of requests for mobile and desktop
------------------------------------------------------------------------------------------
+------------------+-------------+-------------+
|     avg(requests)|min(requests)|max(requests)|
+------------------+-------------+-------------+
|1279.3883227777778|          645|         3292|
+------------------+-------------+-------------+

+------------------+-------------+-------------+
|     avg(requests)|min(requests)|max(requests)|
+------------------+-------------+-------------+
|2426.9947144444445|         1312|         5695|
+------------------+-------------+-------------+

------------------------------------------------------------------------------------------
Which day of the week does wiki get most traffic?
------------------------------------------------------------------------------------------
+---------------+-------------+
|Day of the week|sum(requests)|
+---------------+-------------+
|            Tue|   1995034884|
|            Thu|   1931508977|
|            Sat|   1662762048|
|            Sun|   1576726066|
|            Fri|   1842512718|
|            Mon|   2356818845|
|            Wed|   1977615396|
+---------------+-------------+

------------------------------------------------------------------------------------------
Compare mobile and desktop requests by Day of the week
------------------------------------------------------------------------------------------
For mobile
+---------------+--------------+
|Day of the week|total_requests|
+---------------+--------------+
|Fri            |635169886     |
|Mon            |790026669     |
|Sat            |646334635     |
|Sun            |629556455     |
|Thu            |625338164     |
|Tue            |648087459     |
|Wed            |631284694     |
+---------------+--------------+

For desktop
+---------------+--------------+
|Day of the week|total_requests|
+---------------+--------------+
|Fri            |1207342832    |
|Mon            |1566792176    |
|Sat            |1016427413    |
|Sun            |947169611     |
|Thu            |1306170813    |
|Tue            |1346947425    |
|Wed            |1346330702    |
+---------------+--------------+

------------------------------------------------------------------------------------------

